"use strict";var app=angular.module("uiRouterSample",["angular-table","toggle-switch"]).run(["$rootScope",function(){}]);angular.module("uiRouterSample").factory("recoFactory",function(e){var t=document.getElementsByClassName("dvCustId")[0].innerText;return{getPurchases:function(){return e.get("/_vti_bin/ProfitguardRecommendationsWCF.svc/GetPurchases/"+t)},getRecommendations:function(){return e.get("/_vti_bin/ProfitguardRecommendationsWCF.svc/GetRecommendations/"+t)}}}),angular.module("uiRouterSample").controller("filters",function(e){e.filters={},$traceurRuntime.setProperty(e.filters,"Primary Wholesaler",{enabled:!1,text:["Endorsed Wholesaler Contract to PBA","Endorsed Wholesaler Non-Contract to Endorsed Wholesaler Contract","Endorsed Wholesaler Contract to Endorsed Wholesaler Contract","Endorsed Wholesaler Non-Contract to PBA"]}),$traceurRuntime.setProperty(e.filters,"From PBA",{enabled:!1,text:["PBA to Endorsed Wholesaler Contract"]}),$traceurRuntime.setProperty(e.filters,"Source",{enabled:!1,text:["Endorsed Wholesaler Contract to PBA","Endorsed Wholesaler Contract to Endorsed Wholesaler Contract","PBA to Endorsed Wholesaler Contract"]}),$traceurRuntime.setProperty(e.filters,"Non Contract",{enabled:!1,text:["Endorsed Wholesaler Non-Contract to Endorsed Wholesaler Contract","Endorsed Wholesaler Non-Contract to PBA"]}),e.filterClick=function(t,r){var o=t;if(0==e.showValue){console.log("compact view sort"),e.destroy();for(var n=(document.getElementById("queryTable"),document.getElementsByClassName("mainRows")),a=0;a<n.length;a++){var s=(_.findWhere(e.myRecommendations,{RowID:n[$traceurRuntime.toProperty(a)].id}),_.findWhere(e.myPurchases,{RowID:n[$traceurRuntime.toProperty(a)].id}));n[$traceurRuntime.toProperty(a)].cells[0].innerHTML=s.NDC}var n=""}var i=document.getElementById(r.target.id);1==e.filters[$traceurRuntime.toProperty(o)].enabled?(e.filters[$traceurRuntime.toProperty(o)].enabled=!1,i.className=r.target.id):(e.filters[$traceurRuntime.toProperty(o)].enabled=!0,i.className+=" "+r.target.id+"Red"),e.ammend()},e.ammend=function(){var t=[],r=!1;for(var o in e.filters)if(e.filters[$traceurRuntime.toProperty(o)].enabled){r=!0;for(var n=!0,a=t.length>0?t:[],s=t.length>0?t:e.$parent.myPurchases_copy,i=0;i<e.filters[$traceurRuntime.toProperty(o)].text.length;i++){if(!n){var c=_.reject(a,function(t){return t.RecoType==e.filters[$traceurRuntime.toProperty(o)].text[$traceurRuntime.toProperty(i)]});a=c}if(n){var c=_.reject(s,function(t){return t.RecoType==e.filters[$traceurRuntime.toProperty(o)].text[$traceurRuntime.toProperty(i)]});a=c;var n=!1}}var t=a;e.$parent.myPurchases=a}r||(e.$parent.myPurchases=e.$parent.myPurchases_copy),1==e.showValue?(e.$parent.destroy(),setTimeout(function(){e.$parent.ammendment()},100)):0==e.showValue&&setTimeout(function(){for(var t=[],t=(document.getElementById("queryTable"),document.getElementsByClassName("mainRows")),r=0;r<t.length;r++){var o=_.findWhere(e.myRecommendations,{RowID:t[$traceurRuntime.toProperty(r)].id}),n=_.findWhere(e.$parent.myPurchases_copy,{RowID:t[$traceurRuntime.toProperty(r)].id});t[$traceurRuntime.toProperty(r)].cells[0].innerHTML=n.NDC+"<button class='btn btn-info btn-sm' id='b"+o.RowID+"'>Recommendations</button>",t[$traceurRuntime.toProperty(r)].cells[0].id=o.RowID,angular.element(t[$traceurRuntime.toProperty(r)].cells[0]).on("click",function(t){for(var r=t.target.id.substring(1),o=_.findWhere(e.myRecommendations,{RowID:r}),n=document.getElementsByClassName("subRow"),a=0;a<n.length;a++)n[$traceurRuntime.toProperty(a)].remove();e.miniAmmend(r,o)})}},100)}}),angular.module("uiRouterSample").controller("TodoCtrl",function(e,t,r){e.myPurchases=[],e.myPurchases_copy={},e.selected=0,t.getPurchases().then(function(t){var r=[];t.data.aaData.forEach(function(e){e.TotalSavings=parseFloat(parseFloat(e.TotalSavings).toFixed(2)),e.RecoType_small="PBA to Endorsed Wholesaler Contract"==e.RecoType?"PBA Health":"Primary Wholesaler",e.SalesPrice=parseFloat(e.SalesPrice).toFixed(2),e.Total=parseFloat(e.Total).toFixed(2),e.TotalSavings2=parseFloat(e.TotalSavings).toFixed(2),r.push(e)}),e.myPurchases=r,e.myPurchases_copy=r,e.myRecommendations.length>0&&e.blender,e.pagination[3].shade=r.length}),e.myRecommendations=[],t.getRecommendations().then(function(t){var r=[];t.data.aaData.forEach(function(e){e.RecoType="Endorsed Wholesaler Contract to PBA"==e.RecoType?"PBA Health":"Primary Wholesaler",r.push(e)}),e.myRecommendations=r,e.ammendment(),e.blender()}),e.selectChanged=function(t){e.tableConfig.oldAmount=e.tableConfig.itemsPerPage,e.tableConfig.itemsPerPage=t.shade,e.destroy(),setTimeout(function(){e.ammendment()},100)},e.pagination=[{name:5,shade:5},{name:10,shade:10},{name:20,shade:20},{name:"All",shade:3}],e.myPagination=e.pagination[0],e.tableConfig={itemsPerPage:e.myPagination.shade,fillLastPage:!1,maxPages:10,oldAmount:e.myPagination.shade},e.tableConfig.currentPage=1,e.$watch("tableConfig.currentPage",function(t,r){if(t!==r){if(0==e.showValue)return e.destroy(),void setTimeout(function(){for(var t=(document.getElementById("queryTable"),document.getElementsByClassName("mainRows")),r=0;r<t.length;r++){var o=_.findWhere(e.myRecommendations,{RowID:t[$traceurRuntime.toProperty(r)].id});console.log(o.Descr);var n=_.findWhere(e.myPurchases,{RowID:t[$traceurRuntime.toProperty(r)].id});t[$traceurRuntime.toProperty(r)].cells[0].innerHTML=n.NDC+"<button class='btn btn-info btn-sm' id='b"+o.RowID+"'>Recommendations</button>",t[$traceurRuntime.toProperty(r)].cells[0].id=o.RowID,angular.element(t[$traceurRuntime.toProperty(r)].cells[0]).on("click",function(t){for(var r=t.target.id.substring(1),o=_.findWhere(e.myRecommendations,{RowID:r}),n=document.getElementsByClassName("subRow"),a=0;a<n.length;a++)n[$traceurRuntime.toProperty(a)].remove();e.miniAmmend(r,o)})}},100);e.destroy(e.tableConfig.itemsPerPage),setTimeout(function(){e.ammendment()},100)}}),e.ammendment=function(){if(0==e.myPurchases.length||0==e.myRecommendations)return void setTimeout(function(){e.ammendment()},1e3);for(var t=e.tableConfig.itemsPerPage,r=document.getElementById("queryTable"),o=document.getElementsByClassName("mainRows"),n=0;t>n;n++){var a=r.insertRow(o[$traceurRuntime.toProperty(n)].rowIndex+1),s=_.findWhere(e.myRecommendations,{RowID:o[$traceurRuntime.toProperty(n)].id}),i=_.findWhere(e.myPurchases,{RowID:o[$traceurRuntime.toProperty(n)].id});a.id="row"+n,a.className="subRow";var c=a.insertCell(0);c.colSpan=11,c.innerHTML='<p class="printBoxes smaller" ><input type="checkbox" data-rowid="'+i.RowID+'" id="checkbox'+i.RowID+"\"> Print? </p><p class='recSupply'>Recommendation: "+s.NDC+"</p> <p>MFG:  "+s.MfgName+"</p> <p class='smaller'>Size: "+s.Size+"</p>  <p class='smaller'>Price:  $"+s.RecSalesPrice+"</p> <p class='recSupply'>Supplier:  "+s.RecoType+"</p> ",a.cells[0].className="Bubba",1==i.checked&&(document.getElementById("checkbox"+o[$traceurRuntime.toProperty(n)].id).checked=!0)}e.applyEvents()},e.applyEvents=function(){for(var t=(e.tableConfig.itemsPerPage,document.getElementById("queryTable"),document.getElementsByClassName("printBoxes")),r=0;r<t.length;r++)angular.element(t[$traceurRuntime.toProperty(r)]).on("click",function(t){var r=document.getElementById(t.target.id),o=t.target.dataset.rowid;if(r.checked){var n=_.findWhere(e.myPurchases,{RowID:o});n.checked=r.checked,e.$apply(function(){e.selected++})}else{var n=_.findWhere(e.myPurchases,{RowID:o});n.checked=r.checked,e.$apply(function(){e.selected--})}})},e.printAll=function(){var t=r;t.sessionStorage.purchases=angular.toJson(e.myPurchases),t.sessionStorage.recommendations=angular.toJson(e.myRecommendations),t.sessionStorage.printText="Showing All",t.open("/views/printAll.html")},e.printSelected=function(){var t=r,o=_.where(e.myPurchases,{checked:!0});t.sessionStorage.purchases=angular.toJson(o),t.sessionStorage.recommendations=angular.toJson(e.myRecommendations),t.sessionStorage.printText="Showing "+o.length+" of "+e.pagination[3].shade,t.open("/views/printAll.html")},e.blender=function(){if(0==e.myPurchases.length||0==e.myRecommendations)return void setTimeout(function(){e.blender()},1e3);for(var t=0;t<e.myPurchases.length;t++){var r=_.findWhere(e.myRecommendations,{RowID:e.myPurchases[$traceurRuntime.toProperty(t)].RowID});r.UnitPrice=(parseFloat(r.RecSalesPrice)/parseFloat(r.Size)).toFixed(2),r.RecSalesPrice=parseFloat(r.RecSalesPrice).toFixed(2),e.myPurchases[$traceurRuntime.toProperty(t)].Reco=r,e.myPurchases[$traceurRuntime.toProperty(t)].TotalSavings_string=parseFloat(e.myPurchases[$traceurRuntime.toProperty(t)].TotalSavings).toFixed(2),e.myPurchases[$traceurRuntime.toProperty(t)].UnitPrice=(parseInt(e.myPurchases[$traceurRuntime.toProperty(t)].SalesPrice)/parseInt(e.myPurchases[$traceurRuntime.toProperty(t)].Size)).toFixed(2)}},e.removePrint=function(t){e.selected--;var r=_.findWhere(e.myPurchases,{RowID:t.target.id});r.checked=!1;var o=document.getElementById("checkbox"+t.target.id);o.checked=!1},e.destroy=function(){for(var e=(document.getElementById("queryTable"),document.getElementsByClassName("subRow")),t=0;t<e.length;t++)e[$traceurRuntime.toProperty(t)].remove(),t--},e.showStatus="Collapse",e.showValue=1,e.magic=function(){if(0==e.showValue){e.showStatus="Collapse",e.showValue=1,e.destroy(),e.ammendment();for(var t=(document.getElementById("queryTable"),document.getElementsByClassName("mainRows")),r=0;r<t.length;r++){var o=_.findWhere(e.myRecommendations,{RowID:t[$traceurRuntime.toProperty(r)].id}),n=_.findWhere(e.myPurchases,{RowID:t[$traceurRuntime.toProperty(r)].id});t[$traceurRuntime.toProperty(r)].cells[0].innerHTML=n.NDC}}else{e.showStatus="Expand",e.showValue=0,e.destroy();for(var t=(document.getElementById("queryTable"),document.getElementsByClassName("mainRows")),r=0;r<t.length;r++){var o=_.findWhere(e.myRecommendations,{RowID:t[$traceurRuntime.toProperty(r)].id}),n=_.findWhere(e.myPurchases,{RowID:t[$traceurRuntime.toProperty(r)].id});t[$traceurRuntime.toProperty(r)].cells[0].innerHTML=n.NDC+"<button class='btn btn-info btn-sm' id='b"+o.RowID+"'>Recommendations</button>",t[$traceurRuntime.toProperty(r)].cells[0].id=o.RowID,angular.element(t[$traceurRuntime.toProperty(r)].cells[0]).on("click",function(t){for(var r=t.target.id.substring(1),o=_.findWhere(e.myRecommendations,{RowID:r}),n=document.getElementsByClassName("subRow"),a=0;a<n.length;a++)n[$traceurRuntime.toProperty(a)].remove();e.miniAmmend(r,o)})}}},e.miniAmmend=function(t,r){console.log("Mini ammend?",t);var o=document.getElementById("queryTable"),n=document.getElementById(t),a=_.findWhere(e.myPurchases,{RowID:t}),s=o.insertRow(n.rowIndex+1);s.id="row",s.className="subRow";var i=s.insertCell(0);i.colSpan=11,i.innerHTML='<p class="printBoxes smaller" ><input type="checkbox" data-rowid="'+a.RowID+'" id="checkbox'+a.RowID+"\"> Print? </p><p class='recSupply'>Recommendation: "+r.NDC+"</p> <p>MFG:  "+r.MfgName+"</p> <p class='smaller'>Size: "+r.Size+"</p>  <p class='smaller'>Price:  $"+r.RecSalesPrice+"</p> <p class='recSupply'>Supplier:  "+r.RecoType+"</p> ",1==a.checked&&(document.getElementById("checkbox"+t).checked=!0),e.applyEvents()}}),angular.module("uiRouterSample").controller("printCtrl2",function(e,t,r){e.addPrint=function(t,r){if("checkbox"==r.target.type){console.log("CHECKED");var o=_.findWhere(e.myPurchases,{RowID:t});return o.checked=document.getElementById("checkbox"+t).checked,void(o.checked?e.selected++:e.selected--)}if(document.getElementById("checkbox"+t).checked){document.getElementById("checkbox"+t).checked=!1;var o=_.findWhere(e.myPurchases,{RowID:t});o.checked=!1,e.selected--}else{document.getElementById("checkbox"+t).checked=!0;var o=_.findWhere(e.myPurchases,{RowID:t});o.checked=!0,e.selected++}},e.printAll=function(){var t=r;t.sessionStorage.purchases=angular.toJson(e.myPurchases),t.sessionStorage.recommendations=angular.toJson(e.myRecommendations),t.sessionStorage.printText="Showing All",t.open("/views/printAll.html")},e.printSelected=function(){var t=r,o=_.where(e.myPurchases,{checked:!0});t.sessionStorage.purchases=angular.toJson(o),t.sessionStorage.recommendations=angular.toJson(e.myRecommendations),t.sessionStorage.printText="Showing "+o.length+" of "+e.pagination[3].shade,t.open("/views/printAll.html")}}),angular.module("uiRouterSample").controller("print_page_Ctrl",function(e){e.printText=sessionStorage.printText,e.myPurchases=JSON.parse(sessionStorage.purchases),e.myRecommendations=JSON.parse(sessionStorage.recommendations);for(var t=0;t<e.myPurchases.length;t++){var r=_.findWhere(e.myRecommendations,{RowID:e.myPurchases[$traceurRuntime.toProperty(t)].RowID});r.UnitPrice=(parseFloat(r.RecSalesPrice)/parseFloat(r.Size)).toFixed(2),r.RecSalesPrice=parseFloat(r.RecSalesPrice).toFixed(2),e.myPurchases[$traceurRuntime.toProperty(t)].Reco=r,e.myPurchases[$traceurRuntime.toProperty(t)].TotalSavings_string=parseFloat(e.myPurchases[$traceurRuntime.toProperty(t)].TotalSavings).toFixed(2),e.myPurchases[$traceurRuntime.toProperty(t)].UnitPrice=(parseInt(e.myPurchases[$traceurRuntime.toProperty(t)].SalesPrice)/parseInt(e.myPurchases[$traceurRuntime.toProperty(t)].Size)).toFixed(2)}window.print()});